game_slug: silent-hill-4-the-room
name: "Silent Hill 4: The Room"
year: 2004
user: eskay993
runner: wine
slug: silent-hill-4-gog
version: "PC-DVD"
description: |
  Updated installer for the PC-DVD version which will install the widescreen patch as well as XInput Fix, Silent Hill 3 PC Sound Fix, No-DVD patch and configures controls to match PS2 (see notes below). Works on Steam Deck too.
notes: 
script:
  # files:
  # - nodvd_patch: N/A:sh3.exe (No-DVD patched)
  # - widescreen_patch: https://github.com/ThirteenAG/WidescreenFixesPack/releases/download/sh3/SilentHill3.WidescreenFix.zip
  # - xinputplus_zip: https://github.com/eskay993/gamefiles/raw/main/silent-hill-3/patches/SilentHill3.XInputFix.zip
  # - fixwavs_zip: https://github.com/eskay993/gamefiles/raw/main/silent-hill-3/patches/SH3PC.Sound.Fixer_(wine).zip
  game:
    arch: win32
    exe: drive_c/Program Files/Konami/SILENT HILL 4/SILENT HILL 4.exe
    prefix: $GAMEDIR
  installer:
  - task:
      arch: win32
      description: Creating Wine prefix...
      name: create_prefix
      prefix: $GAMEDIR
  - input_menu:
      description: "Select a resolution for the game:"
      id: GAMERES
      # Note: Steam Deck in desktop mode reports res as 800x1280. This is adjusted for later on.
      options:
      - 1280x720: 1280x720
      - 800x1280: 1280x800 (Steam Deck)
      - 1920x1080: 1920x1080
      - 2560x1440: 2560x1440
      - 3840x2160: 3840x2160
      preselect: $RESOLUTION
  - insert-disc:
      description: Waiting for game installer...
      message: Select the path for the Silent Hill 4 DVD
      requires: sh4.ico
  - write_file:
      content: '[{14D10AAC-9737-454E-A247-8075C26C30E1}-DlgOrder]

        Dlg0={14D10AAC-9737-454E-A247-8075C26C30E1}-SdWelcome-0

        Count=6

        Dlg1={14D10AAC-9737-454E-A247-8075C26C30E1}-SdLicense-0

        Dlg2={14D10AAC-9737-454E-A247-8075C26C30E1}-SdAskDestPath-0

        Dlg3={14D10AAC-9737-454E-A247-8075C26C30E1}-SdComponentTree-0

        Dlg4={14D10AAC-9737-454E-A247-8075C26C30E1}-SdStartCopy-0

        Dlg5={14D10AAC-9737-454E-A247-8075C26C30E1}-SdFinish-0

        [{14D10AAC-9737-454E-A247-8075C26C30E1}-SdWelcome-0]

        Result=1

        [{14D10AAC-9737-454E-A247-8075C26C30E1}-SdLicense-0]

        Result=1

        [{14D10AAC-9737-454E-A247-8075C26C30E1}-SdAskDestPath-0]

        szDir=C:\Program Files\Konami\SILENT HILL 4\

        Result=1

        [{14D10AAC-9737-454E-A247-8075C26C30E1}-SdComponentTree-0]

        szDir=C:\Program Files\Konami\SILENT HILL 4\

        Component-type=string

        Component-count=6

        Component-0=Exe

        Component-1=ConfigExe

        Component-2=MainApp

        Component-3=Sound

        Component-4=SoundDemo

        Component-5=Movie

        Result=1

        [{14D10AAC-9737-454E-A247-8075C26C30E1}-SdStartCopy-0]

        Result=1

        [{14D10AAC-9737-454E-A247-8075C26C30E1}-SdFinish-0]

        Result=1

        bOpt1=0

        bOpt2=0'
      file: $GAMEDIR/drive_c/setup.iss
  - task:
      description: |
        Installing Game, this will take a while...

        ****** NOTE: ******
        It may appear as if Lutris has frozen, and/or your mouse stops moving. Just wait for the installer to move on to the next step and should be fine.
      executable: $DISC/setup.exe
      name: wineexec
      prefix: $GAMEDIR
  - task:
      app: win7
      arch: win32
      name: winetricks
      prefix: $GAMEDIR
  - task:
      app: d3dx9_43
      arch: win32
      name: winetricks
      prefix: $GAMEDIR
  - task:
      app: wmp10
      arch: win32
      description: Installing wmp10
      name: winetricks
      prefix: $GAMEDIR      
  wine:
    overrides:
      d3d8.dll: n,b
      dinput8.dll: n,b
      dsound.dll: n,b
    version: lutris-fshack-7.1-x86_64    